* PELM-misc
** TODO refactory code

#+BEGIN_SRC emacs-lisp

;;; pelm-misc.el --- PELM misc
;;
;; Copyight (c) 2011-2015 eggcaker
;;
;; Authors: eggcaker <eggcaker@gmail.com>
;; URL: http://caker.me/pelm


;; This file is not part of GNU Emacs

;;; Code:


(defun pelm/insert-date ()
  (interactive)
  (insert (format-time-string "%Y-%m-%d %A")))

(defun pelm/insert-time ()
  (interactive)
  (insert (format-time-string "%X")))

(evil-leader/set-key
  "xid" 'pelm/insert-date
  "xit" 'pelm/insert-time)

(require 'find-dired)
(setq find-ls-option '("-print0 | xargs -0 ls -ld" . "-ld"))

(setq display-time-day-and-date t
      display-time-24hr-format t)

;  (setq system-time-locale "en_US.utf8")
   (setq system-time-locale "C")

(display-time )

;(setq system-time-locale "C")

(fset 'format_xml
      (lambda (&optional arg)
        "Keyboard macro."
        (interactive "p")
        (kmacro-exec-ring-item (quote ([19 34 32 13 return] 0 "%d")) arg)))

(defun pelm/start-work()
  "pull all repos before start work "
  (interactive)
  (pelm-clock-in-task-by-id "4233C029-C856-422C-A0F6-8E6EF2E40698")
  (org-mobile-pull)
  (async-shell-command  "~/.zsh-it/bin/c.sw"))

(defun pelm/end-work()
  "push all repos before end of work"
  (interactive)
  (org-save-all-org-buffers)
  (pelm-clock-in-task-by-id "E84E9FE4-7BFF-41CD-A88A-B167DB8EA065")
  (org-mobile-push)
  (async-shell-command "~/.zsh-it/bin/c.gh"))

(evil-leader/set-key
      "ps" 'pelm/start-work
      "pe" 'pelm/end-work)

(require 'jabber)
(setq jabber-account-list
      '(
        ("eggcaker@gmail.com"
         (:connection-type . ssl)
         (:network-server . "talk.google.com")
         (:port . 5223))))

(custom-set-variables
 '(auto-save-list-file-prefix "~/.emacs.d/.cache/auto-save-list/.saves-")
  '(jabber-auto-reconnect nil)
  '(jabber-avatar-verbose nil)
  '(jabber-vcard-avatars-retrieve nil)
  '(jabber-chat-buffer-format "*-jabber-%n-*")
  '(jabber-history-enabled t)
  '(jabber-mode-line-mode t)
  '(jabber-roster-buffer "*-jabber-*")
  '(jabber-roster-line-format " %c %-25n %u %-8s (%r)")
  '(jabber-show-offline-contacts nil))

(define-key pelm-keymap "p" 'epresent-run)

;; 2048 game
(eval-after-load "2048-game"
   '(progn
  (define-key 2048-mode-map (kbd "k") '2048-up)
  (define-key 2048-mode-map (kbd "j") '2048-down)
  (define-key 2048-mode-map (kbd "h") '2048-left)
  (define-key 2048-mode-map (kbd "l") '2048-right)))

;; emacs server start
;; only started when running on GUI emacs
(require 'server)
(if window-system
    (unless (server-running-p)
      (server-start)))

#+END_SRC
